"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[50],{9863:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>u,frontMatter:()=>d,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"enc_dec","title":"Leaderboard Pseudocode","description":"---","source":"@site/docs/enc_dec.md","sourceDirName":".","slug":"/enc_dec","permalink":"/HyperDigits/docs/enc_dec","draft":false,"unlisted":false,"editUrl":"https://github.com/wiindsom/HyperDigits/edit/main/docs/enc_dec.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"defaultSidebar","previous":{"title":"Datastore Pseudocode","permalink":"/HyperDigits/docs/datastore"},"next":{"title":"Example 1","permalink":"/HyperDigits/docs/Usage/first_example"}}');var o=n(4848),a=n(8453);const d={sidebar_position:2},s="Leaderboard Pseudocode",c={},l=[];function i(e){const t={code:"code",h1:"h1",header:"header",hr:"hr",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"leaderboard-pseudocode",children:"Leaderboard Pseudocode"})}),"\n",(0,o.jsx)(t.hr,{}),"\n",(0,o.jsx)(t.p,{children:"What we have here is a pseudocode in how you would get this working with leaderboards."}),"\n",(0,o.jsx)(t.p,{children:"IMPORTANT NOTE: fromString already handles JSONDecoding internally. Therefore why you don't see JSONDecode anywhere."}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-lua",children:'local DataStoreService = game:GetService("DataStoreService")\nlocal HttpService = game:GetService("HttpService")\nlocal Players = game:GetService("Players")\n\nlocal HyperDigits = require("HyperDigits")\n\nlocal currentData = HyperDigits.fromString("1e123")\n\nlocal leaderboardStore = DataStoreService:GetOrderedDataStore("qwerty")\nlocal valueStore = DataStoreService:GetDataStore("abcdef")\n\ntype userData = { key: string, value: number }\n\nlocal function saveData(player: Player, value: HyperDigits.HyperDigits)\n\tlocal current = value:encode()\n\n\tif typeof(current) ~= "number" then\n\t\treturn\n\tend\n\n\tlocal key = tostring(player.UserId)\n\tleaderboardStore:UpdateAsync(key, function(old)\n\t\told = old or 0\n\t\tif current > old then\n\t\t\treturn current\n\t\tend\n\t\treturn old\n\tend)\n\n\tlocal base = value:toBase()\n\tlocal json = HttpService:JSONEncode(base)\n\tvalueStore:SetAsync(key, json)\nend\n\nlocal function getDisplayValue(userId: number, encoded: number)\n\tlocal key = tostring(userId)\n\n\tlocal success, value = pcall(function()\n\t\treturn valueStore:GetAsync(key)\n\tend)\n\n\tif success and type(value) == "string" and value ~= "" then\n\t\tlocal toFormat = HyperDigits.fromString(value)\n\t\treturn toFormat:toString()\n\tend\n\n\treturn HyperDigits.decode(encoded):toString()\nend\n\nlocal function getTop(size: number)\n\tlocal pages = leaderboardStore:GetSortedAsync(true, size)\n\tlocal page = pages:GetCurrentPage()\n\n\tlocal rows = {}\n\tfor rank, entry: userData in page do\n\t\tlocal userId = tonumber(entry.key)\n\t\tlocal encoded = entry.value\n\n\t\tif userId then\n\t\t\tlocal display = getDisplayValue(userId, encoded)\n            \n\t\t\ttable.insert(rows, {\n\t\t\t\trank = rank;\n\t\t\t\tuserId = userId;\n\t\t\t\tencoded = encoded;\n\t\t\t\tdisplay = display;\n\t\t\t})\n\t\tend\n\tend\n\treturn rows\nend\n\nlocal top_10 = getTop(10)\n\nfor _, row in top_10 do\n\tprint(`Rank: {row.rank}`)\n\tprint(`Player: {Players:GetPlayerByUserId(row.userId).Name}`)\n\tprint(`Amount: {row.display}`)\nend\n'})})]})}function u(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(i,{...e})}):i(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>d,x:()=>s});var r=n(6540);const o={},a=r.createContext(o);function d(e){const t=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:d(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);