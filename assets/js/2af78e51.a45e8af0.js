"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[50],{9863:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>c,contentTitle:()=>s,default:()=>u,frontMatter:()=>d,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"enc_dec","title":"Leaderboard Pseudocode","description":"---","source":"@site/docs/enc_dec.md","sourceDirName":".","slug":"/enc_dec","permalink":"/HyperDigits/docs/enc_dec","draft":false,"unlisted":false,"editUrl":"https://github.com/wiindsom/HyperDigits/edit/main/docs/enc_dec.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"defaultSidebar","previous":{"title":"Datastore Pseudocode","permalink":"/HyperDigits/docs/datastore"},"next":{"title":"Example 1","permalink":"/HyperDigits/docs/Usage/first_example"}}');var o=t(4848),a=t(8453);const d={sidebar_position:2},s="Leaderboard Pseudocode",c={},l=[];function i(e){const r={code:"code",h1:"h1",header:"header",hr:"hr",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.header,{children:(0,o.jsx)(r.h1,{id:"leaderboard-pseudocode",children:"Leaderboard Pseudocode"})}),"\n",(0,o.jsx)(r.hr,{}),"\n",(0,o.jsx)(r.p,{children:"What we have here is a pseudocode in how you would get this working with leaderboards."}),"\n",(0,o.jsx)(r.p,{children:"IMPORTANT NOTE: fromString already handles JSONDecoding internally. Therefore why you don't see JSONDecode anywhere."}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-lua",children:'local DataStoreService = game:GetService("DataStoreService")\r\nlocal HttpService = game:GetService("HttpService")\r\nlocal Players = game:GetService("Players")\r\n\r\nlocal HyperDigits = require("HyperDigits")\r\n\r\nlocal currentData = HyperDigits.fromString("1e123")\r\n\r\nlocal leaderboardStore = DataStoreService:GetOrderedDataStore("qwerty")\r\nlocal valueStore = DataStoreService:GetDataStore("abcdef")\r\n\r\ntype userData = { key: string, value: number }\r\n\r\nlocal function saveData(player: Player, value: HyperDigits.HyperDigits)\r\n\tlocal current = value:encode()\r\n\r\n\tif typeof(current) ~= "number" then\r\n\t\treturn\r\n\tend\r\n\r\n\tlocal key = tostring(player.UserId)\r\n\tleaderboardStore:UpdateAsync(key, function(old)\r\n\t\told = old or 0\r\n\t\tif current > old then\r\n\t\t\treturn current\r\n\t\tend\r\n\t\treturn old\r\n\tend)\r\n\r\n\tlocal base = value:toBase()\r\n\tlocal json = HttpService:JSONEncode(base)\r\n\tvalueStore:SetAsync(key, json)\r\nend\r\n\r\nlocal function getDisplayValue(userId: number, encoded: number)\r\n\tlocal key = tostring(userId)\r\n\r\n\tlocal success, value = pcall(function()\r\n\t\treturn valueStore:GetAsync(key)\r\n\tend)\r\n\r\n\tif success and type(value) == "string" and value ~= "" then\r\n\t\tlocal toFormat = HyperDigits.fromString(value)\r\n\t\treturn toFormat:toString()\r\n\tend\r\n\r\n\treturn HyperDigits.decode(encoded):toString()\r\nend\r\n\r\nlocal function getTop(size: number)\r\n\tlocal pages = leaderboardStore:GetSortedAsync(true, size)\r\n\tlocal page = pages:GetCurrentPage()\r\n\r\n\tlocal rows = {}\r\n\tfor rank, entry: userData in page do\r\n\t\tlocal userId = tonumber(entry.key)\r\n\t\tlocal encoded = entry.value\r\n\r\n\t\tif userId then\r\n\t\t\tlocal display = getDisplayValue(userId, encoded)\r\n            \r\n\t\t\ttable.insert(rows, {\r\n\t\t\t\trank = rank;\r\n\t\t\t\tuserId = userId;\r\n\t\t\t\tencoded = encoded;\r\n\t\t\t\tdisplay = display;\r\n\t\t\t})\r\n\t\tend\r\n\tend\r\n\treturn rows\r\nend\r\n\r\nlocal top_10 = getTop(10)\r\n\r\nfor _, row in top_10 do\r\n\tprint(`Rank: {row.rank}`)\r\n\tprint(`Player: {Players:GetPlayerByUserId(row.userId).Name}`)\r\n\tprint(`Amount: {row.display}`)\r\nend\n'})})]})}function u(e={}){const{wrapper:r}={...(0,a.R)(),...e.components};return r?(0,o.jsx)(r,{...e,children:(0,o.jsx)(i,{...e})}):i(e)}},8453:(e,r,t)=>{t.d(r,{R:()=>d,x:()=>s});var n=t(6540);const o={},a=n.createContext(o);function d(e){const r=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function s(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:d(e.components),n.createElement(a.Provider,{value:r},e.children)}}}]);